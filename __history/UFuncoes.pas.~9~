unit UFuncoes;

interface

uses
  Windows, Forms, SysUtils, Controls, Data.Win.ADODB, IniFiles;

  procedure Encerrar;
  procedure InciarConexao(Conn: TADOConnection; BDConf: String);

implementation

procedure Encerrar;
begin
  //Solicita confirmação para sair do programa
  if Application.MessageBox('Deseja sair do sistema?'
                           ,'Confirmação'
                           ,MB_ICONQUESTION + MB_YESNO) = mrYes then
    //Casso ação seja confirma encerra a aplicação
    Application.Terminate
  else
    Abort;
end;

procedure InciarConexao(Conn: TADOConnection; BDConf: String);
var
  DadosConexao: String;
  ArqConfigBD: TIniFile;
begin
  //with Conn do
    //begin
     if FileExists(BDConf) then
       begin
         try
           ArqConfigBD := TIniFile.Create(ExtractFilePath(Application.ExeName)+BDConf);

           //DadosConexao := ArqConfigBD.ReadString('CONEXAO','CONEXAO','');
         except
           ArqConfigBD.Free;
           Application.MessageBox('Falha ao ler o arquivo de configuração','Erro', MB_ICONERROR + MB_OK);
         end;
       end
     else
       begin
         ArqConfigBD.Free;
         Application.MessageBox(PChar('O arquivo de configuração não foi encontrado'+#13#13+'Arquivo: '+BDConf),'Erro', MB_ICONSTOP + MB_OK);
       end;




      {try
        IniDBConf := ReadIni(IniSysConf,'DatabaseSettings','AliasFile');
        Alias := ReadIni(IniUserPref,'Alias','AliasName');
        DatabaseName := ReadIni(IniDBConf,Alias,'Database');
        if CheckIniSessionExists(IniDBConf,Alias) then
          begin
            ConnectionName := ReadIni(IniDBConf,Alias,'ConnectionName');
            DriverName := ReadIni(IniDBConf,Alias,'DriverName');
            GetDriverFunc := ReadIni(IniDBConf,Alias,'GetDriverFunc');
            LibraryName := ReadIni(IniDBConf,Alias,'LibraryName');
            LoginPrompt := StrToBool(ReadIni(IniDBConf,Alias,'LoginPrompt'));
            VendorLib := ReadIni(IniDBConf,Alias,'VendorLib');

            LoadParamsFromIniFile(IniDBConf);

            Connected := True;
          end
        else
          begin
            Application.MessageBox(PChar('Não foi possível localizar a conexão com o banco de dados '+Alias),'Aviso',MB_ICONEXCLAMATION + MB_OK);
          end;
      except on E: exception do
        begin
          Connected := False;
          Application.MessageBox(PChar('Não foi possível se conectar ao banco de dados '#13#13+'Detalhes: '+E.Message),'Erro de conexão',MB_ICONERROR + MB_OK);
          Exit;
        end;
      end;
    end; }
end;

end.
